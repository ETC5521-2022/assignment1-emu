---
title: "ETC5521 Assignment 1"
subtitle: "Global Fishing"
team: [EMU]
author:
  - [Min Min Soh]
  - [Rohan Baghel]

date: "`r Sys.Date()`"
output:
   bookdown::html_document2:
    toc: yes
    df_print: paged
    number_sections: yes
    fig_caption: yes

---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, 
                      warning = FALSE,
                      message = FALSE,
                      fig.path = "images/",
                      fig.align = "center")
```

# Introduction and motivation

Global fishing has received a great deal of attention in the media for the past decades. The rise of world population over the decades have increased the demand for seafood consumption across the world. Coastal countries such as Iceland and Maldives still mainly rely on fishing as one of the most important food sources.  In this analysis, our first research question would learn about the seafood consumption of each country across the years. We will also study about how much seafood are being produced by each country overtime.  

Meanwhile, the rise of seafood demands has increased pressure on fish stocks across the world. The health of fish population in the world remains as a concern with the rise of global fishing. There are claims that ongoing erosion of aqua diversity will eventually lead to global collapse of fisheries by 2048. It then prompts us to have a closer look at how much of fish stocks are caught within the sustainable levels over the years without overexploiting the fish populations.

Fish farming, also being known as aquaculture come into place, help to contribute to the seafood production  while alleviating the pressure of wild fisheries. This inspires us to further analyse the change in the trend of aquaculture as compared to wild fish catch over time. 

We begin by describing the data in the next section, how we source it and how we prepare the data for analysis. In the analysis section, we present our observations through graphical displays. Our main tool is R, a programming language for statistical computing and graphics, which we use to clean, analyse and graph the data.  


# Data description 


```{r echo=FALSE, message=FALSE, warning=FALSE}
library(tidyverse)
library(ggplot2)
library(tidytuesdayR)
library(plotly)
library(bookdown)
library(visdat)
library(patchwork)
library(maps)
library(kableExtra)
library(readr)
library(ggridges)
library(gganimate)
library(transformr)
library(gifski)
library(viridis)
library(png)

```

```{r echo=FALSE, message=FALSE, warning=FALSE}

captured_vs_farmed <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/capture-fisheries-vs-aquaculture.csv')

consumption <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/fish-and-seafood-consumption-per-capita.csv')

stock <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/fish-stocks-within-sustainable-levels.csv')

production <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/seafood-and-fish-production-thousand-tonnes.csv')
```


The data set has been obtained from the website https://ourworldindata.org. The data comprises of seven files in the ".csv" format which is machine readable and can be used to analyze the state of fish production and consumption in the world. 

The data dictionary for the data set has been given below. They define the variables and their types in each of the data sets that has been given in the data set. 


## `capture-fisheries-vs-aquaculture.csv`

|variable                                   |class     |description |
|:------------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                       |double    | Year|
|Aquaculture production (metric tons)       |double    | Production of aquaculture animals|
|Capture fisheries production (metric tons) |double    | Captured aquaculture |



## `fish-and-seafood-consumption-per-capita.csv`

|variable                                                       |class     |description |
|:--------------------------------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                                           |double    | Year |
|Fish, Seafood- Food supply quantity (kg/capita/yr) (FAO, 2020) |double    | Food supply in fish in kg/capita/year |

## `fish-stocks-within-sustainable-levels.csv`

|variable                                                                |class     |description |
|:-----------------------------------------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                                                    |double    | Year |
|Share of fish stocks within biologically sustainable levels (FAO, 2020) |double    | Share of sustainable fish stock |
|Share of fish stocks that are overexploited                             |double    | Share of fish stock that are overexploited |



## `seafood-and-fish-production-thousand-tonnes.csv`

|variable                                      |class     |description |
|:----------------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                          |double    |.           |
|Pelagic Fish - 2763 - Production - 5510 - tonnes       |double    | Pelagic Fish |
|Crustaceans - 2765 - Production - 5510 - tonnes        |double    | Crustaceans |
|Cephalopods - 2766 - Production - 5510 - tonnes        |double    | Cephalopods |
|Demersal Fish - 2762 - Production - 5510 - tonnes      |double    | Demersal |
|Freshwater Fish - 2761 - Production - 5510 - tonnes    |double    | Freshwater |
|Molluscs, Other - 2767 - Production - 5510 - tonnes    |double    | Molluscs |
|Marine Fish, Other - 2764 - Production - 5510 - tonnes |double    | Marine |

# Questions of interest

Q1 What is the contribution of each production sector in global fishery from 1950 ? 

Q2 **What is the contribution of each country in the global fishery sector ? ** 

Q3 What is the share of type of fishes produced in each country ? 

Q4 What is the production level of each country by capturing over the years ?

Q5 What is the production level of each country by farming over the years  ?

Q6 **What has been the trend of seafood consumption of each country over the years ? ** 

Q7 **What has been the trend of captured vs farmed production of each country over the years ? **   

Q8 **What has been the trend of sustainable levels of fish stocks in the world ? **   

Q9 What is the share of fishes of the that have been been overexploited in the world over the years ? 

Q10 How much of the fish stocks are maintained at sustainable levels in the world of world as compared to overall production level? 

Q11 What is the production level of fish by each continent ?

Q12 What is the consumption level of fish by each continent ?

Q13 What can we learn about the uses of fish catch by countries? 

Q14 What can we learn about the uses of fish catch across the years? 

Q15  Comparing seafood production to seafood consumption across the years 

Q16 What can we learn about the sustainable levels of fishing as compared to farming 

Q17 Would aquaculture alleviate the pressure of seafood consumption across the years? 

Q18 What can we observe about the seafood consumption in coastal countries and landlocked countries over time? 

Q19 What can we observe about the level of seafood being discarded in the world across the years?

Q20 How much fresh water produce in each country over time ? 

# Expected findings 

**What has been the trend of seafood consumption of each country over the years ? ** 

- We would expect that there is an increasing trend of seafood consumption levels over the years given that rise of population. 

- We would expect that coastal countries consumed more seafood than landlocked countries. 

**What has been the trend of captured vs farmed production of each country over the years ? **  

- We would expect that the farmed production to be increasing over the years. 

- We would expect the high technology countries to contribute more to the farmed production. 

**What is the contribution of each country in the global fishery sector ?**

- The expectation is that of growing trend in fishing for each country for feeding the increasing populace.

- Countries that are landlocked or that do not have a big coastline will be contributing less to the fishery sector.

**What has been the trend of sustainable levels of fish stocks in the world ?**

- An increase in the trend of over-exploitation of fish stocks all over the world.

- A decreasing trend in the biologically sustainable levels of fish stocks all over the world.


# Analysis and findings


## **What has been the trend of seafood consumption of each country over the years ?** 

For a broad overview of the changes in seafood consumption, we'll start with the evolution of the average seafood consumption in the world over the years.

### Annual seafood consumption in the World over the years 
```{r echo=FALSE}
# Compute annual average consumption 
consumption <- consumption %>% rename(consumption = `Fish, Seafood- Food supply quantity (kg/capita/yr) (FAO, 2020)`)
annual_consumption <- consumption %>% group_by(Year) %>%
  summarise(av_consumption = mean(consumption, na.rm=TRUE))
```

```{r worldconsumption,  echo=FALSE, warning = FALSE, message = FALSE, preserve = TRUE, fig.pos = 'H', out.extra = "", fig.cap = "Average seafood consumption in the world over time"}
library(plotly)
p1 <- 
  ggplot(data = annual_consumption,
         aes(x = Year, y = av_consumption)) +
  geom_line(colour = "red") +
  labs(y = "Average consumption (kg) per person per year") +
  scale_x_continuous(breaks = seq(min(annual_consumption$Year), max(annual_consumption$Year), by=5))
ggplotly(p1)
```

Figure \@ref(fig:worldconsumption) shows the trend of world seafood consumption across the population, measured in kilograms per person per year.  

We observe an increasing trend in world seafood consumption from 1961 and it peaked in 1989. However, it is worth noting that the figure declined between 1990 and 1992.   The resulting drop was marked mainly due to the rise in global  prices and food security issues as mentioned in (The state of food and agriculture, 1989).  Public concerns about processing standards for seafood products and water pollution have gave rise to the safety concerns on consuming seafood products, leading to the reduction in the seafood consumption.  In addition to safety concerns, economic and financial difficulties remained an issue especially in the heavily indebted oil-exporting countries and low-income countries,  such as Africa, Latin America, the Carribean and the Near East East. This led to an increased pressure on the price of many products (Dumas, M. W. (1992)). After the crisis has recovered, seafood consumption has gradually increased throughout the world. The rise is because of the positive relation between health and seafood as consumers consider seafood as highly regarded for its abundance of high-quality nutrients, including proteins, polyunsaturated fatty acids and minerals, which are beneficial to health (Hosomi, R., Yoshida, M., & Fukunaga, K. (2012)). Overall, this is consistent with our expectation, a clear illustration of the increasing popularity of seafood consumption. 

This simple plot suggest some directions for further exploration. Are these patterns the same for all countries? To investigate this, we'll follow the same procedure. We will partition the data based on the different nations.  

### Countries with the highest average consumption and the lowest average consumption  

We've decided to look into the 10 countries with the highest average consumption and the 10 countries with the lowest average consumption, as the patterns of the other countries are pretty similar and the plots will be very congested with all countries included. As the original dataset provided contains other regions such as Central Africa Republic and Central America, we've performed an inner join with the dataset called iso3166 from the *maps* package to extract only countries relevant dataset. 


The 10 countries with the highest average consumption from 1961 to 2017 are summarised in the table \@ref(tab:top10tbl) while table \@ref(tab:low10tbl) contains the list of 15 countries with the lowest average consumption.  These results are consistent with our expectations, where the 10 countries with the highest average consumption are all coastal countries.   Seafood is frequently the primary source of food and employment in coastal countries.


```{r echo=FALSE}
#Extract countries from dataset called iso3166 from the {maps} package
dat <- iso3166  
dat <- dat %>% mutate(ISOname = toupper(ISOname)) 
dat <-  dat %>%rename(Entity = ISOname)
consumption <-  consumption %>% mutate(Entity = toupper(Entity))
# Include only countries in captured vs farmed data 
country_cons <- inner_join(consumption, dat, by = "Entity")
```

```{r top10tbl, echo=FALSE}
#Compute annual average consumption per capita across years 
#Select top 10 countries and lowest 10 countries 
highest_consumption   <- country_cons %>% group_by(Entity) %>%
  summarise(avg_consumption = mean(consumption ))%>%
  arrange(-avg_consumption)%>%
  mutate(rank = row_number())%>%
  filter(rank %in% 1:10) %>%
  rename(`Average Consumption (kg) per person per capita` = avg_consumption)
kable(head(highest_consumption,10), caption = "10 countries with the highest consumption") %>% 
  kable_styling(font_size = 15, bootstrap_options = c("striped", "hover", "condensed"))
```

```{r  low10tbl, echo=FALSE}
lowest_consumption <- country_cons %>% group_by(Entity) %>% 
  summarise(avg_consumption = mean(consumption ))%>%
  arrange(avg_consumption)%>%
  mutate(rank = row_number())%>%
  filter(rank %in% 1:10)%>%
  rename(`Average Consumption (kg) per person per capita` = avg_consumption)
kable(head(lowest_consumption,10), caption = "10 countries with the lowest consumption") %>% 
  kable_styling(font_size = 15, bootstrap_options = c("striped", "hover", "condensed"))
```



### Geographic Differences : Trend in seafood consumption for top 10 nations 

In this section we explore the changes in seafood consumption over time in the 10 countries with the highest average seafood consumption. Recall that in our earlier discussion of seafood consumption trend in the world where we observe a decrease in 1989. We then insert a vertical dashed line at the point where year is 1989 for comparison purposes.  

```{r countryconsumption1,  echo=FALSE, preserve = TRUE, fig.pos = 'H', out.extra = "", fig.cap = "Seafood consumption among the top 10 countries over time"}
#trend in consumption for top 10 nations
top10_consumption<- consumption %>% filter(Entity %in% highest_consumption$Entity) 
top3 <- ggplot(data = top10_consumption,
         aes(x = Year, y = consumption, colour = Entity)) +
  geom_path()+
  geom_line()+
  geom_vline(xintercept= 1989, colour = "grey", linetype = "dashed")+
   labs(y = "Average consumption (kg) per year") +
  ggtitle("Seafood consumption per capita per person per year (kg)")+
  scale_x_continuous(breaks = seq(min(annual_consumption$Year), max(annual_consumption$Year), by=10))
plot.animation= top3+
transition_reveal(Year)+
view_follow(fixed_y=T)
animate(plot.animation, height=365,width=608,fps=30,duration=10,end_pause = 120,res=100,rewind=F)
anim_save("Seafood consumption per capita among the top 10 countries.gif")
```


```{r countryconsumption2,  echo=FALSE, preserve = TRUE, fig.pos = 'H', out.extra = "", fig.cap = "Seafood consumption among the top 10 countries over time.  This plot is the same as previous plot but it allows interative plot elements. "}
library(plotly)
ggplotly(top3)  
```


```{r countryconsumption3,  echo=FALSE, preserve = TRUE, fig.pos = 'H', out.extra = "", fig.cap = "Individual plots of the seafood consumption over time among the top 10 countries" }
top4 <- ggplot(data = top10_consumption,
         aes(x = Year, y = consumption)) +
  geom_path()+
  geom_line() +
  geom_vline(xintercept= 1989, colour = "grey", linetype = "dashed")+
  labs(y = "Seafood consumption per capita per person per year (kg)") +
  scale_x_continuous(breaks = seq(min(top10_consumption$Year), max(top10_consumption$Year), by=15))+
  scale_y_continuous(breaks = seq(min(top10_consumption$consumption), max(top10_consumption$consumption), by=30))+
  facet_wrap(~Entity)
ggplotly(top4)
```

There is considerable variation in seafood consumption trend among top 10 countries. As shown in figure \@ref(fig:countryconsumption2) and figure \@ref(fig:countryconsumption3), we observe an increasing trend from 1961 to 1989 for most of the countries except for Portugal where there's a sharp decrease in 1969. Interestingly, some of the countries like Hong Kong and Malaysia display an increasing trend in 1989 where the other countries are showing a decreasing trend in the seafood consumption, similar to what we have observed previously in the world trend in figure \@ref(fig:worldconsumption). This is mainly associated with the improvements of economic conditions in Asia in 1988 along with the recovery of production where food production as a whole remained stable and price inflation remained moderate (Food and Agricultural Organisation of the United Stations, 1989). Notably, seafood consumption in Maldives is the highest compared to the other nations and the trend fluctuates overtime. Fisheries sector has been a contributing sector for Maldives in employment, exports and food security. The trend is declining after 2010, due to a combination of factors, including overfishing, employment falling and higher fuel costs (Salinas, E., Van Doorn, R., & Redaelli, S. (2015)). Solomon islands and Japan also show a declining trend in seafood consumption too, which are mainly due to the overfishing problem.  Overall, these 10 countries display a different result to our expectations, even though some countries are showing an increasing trend in seafood consumption, there are others which show a decline in consumption. 

```{r countryconsumption4,  echo=FALSE, preserve = TRUE, fig.pos = 'H', out.extra = "", fig.cap = "Seafood consumption among the lowest 10 countries over time"}
low10_consumption <- consumption %>% filter(Entity %in% lowest_consumption$Entity) 
low2 <- ggplot(data = low10_consumption,
         aes(x = Year, y = consumption, colour = Entity)) +
  geom_path()+
  geom_line()+
  geom_vline(xintercept= 1989, colour = "grey", linetype = "dashed")+
   labs(y = "Average consumption (kg) per year") +
  ggtitle("Seafood consumption per capita per person per year (kg)")+
  scale_x_continuous(breaks = seq(min(annual_consumption$Year), max(annual_consumption$Year), by=10))
plot.animation= low2+
transition_reveal(Year)+
view_follow(fixed_y=T)
animate(plot.animation, height=365,width=608,fps=30,duration=10,end_pause = 120,res=100,rewind=F)
anim_save("Seafood consumption per capita among the low 10 countries.gif")
```


## **What has been the trend of captured vs farmed production of each country over the years ? **

Aquaculture also being known as fish and seafood farming acts as one of the primary source of protein as human population continues to expand to meet shortfalls in fish supplies.  Aquaculture also plays an important role in employment opportunities.  


### Change in aquaculture and capture fishery production in the world 

First, we'll be exploring the trend of aquaculture in the world over the years as compared to wild fish captured.  We'll be using the dataset `captured_vs_farmed`. This dataset is already in tidy form. 

In figure  \@ref(fig:cf1), we can observe the change in capture fishery production and aquaculture from 1960 onwards. Global wild fish catch remained quite constant from year 2000 onwards, contributing to around 90 to 95 metric tons  per year. In contrast, aquaculture is growing rapidly since 1980s and it surpasses wild fish catch in 2013 to over 100 million metric tons per year. It is consistent with our initial expectation, where aquaculture  has developed increasingly over time. 

```{r echo=FALSE }
captured_vs_farmed  <- captured_vs_farmed %>% 
  rename(aquaculture = `Aquaculture production (metric tons)`,
         captured = `Capture fisheries production (metric tons)`)

captured_vs_farmed<- captured_vs_farmed %>% mutate(Entity = toupper(Entity))

country_cf <- inner_join(captured_vs_farmed, dat, by = "Entity")

captured_vs_farmed_long  <- captured_vs_farmed %>% pivot_longer(cols = aquaculture:captured,
                                                           names_to = "production_type",
                                                           values_to = "production")
```

```{r cf1, echo=FALSE, , preserve = TRUE, fig.pos = 'H', out.extra = "", fig.cap = "Captured fishery production VS Aquaculture in the world"}
# Captured vs Farmed trend in the world 
world_cap_farm <- captured_vs_farmed_long %>% filter(Entity =="WORLD") 
cap_farm_trend <- 
ggplot(world_cap_farm , aes(x = Year, y = production, colour = production_type ))+
  geom_path()+
  geom_line() +
  xlab("Year")+
  ylab("Average production (metric tons)")+
  scale_y_continuous(labels = scales::label_comma(scale = 1e-6) )+
  scale_x_continuous(breaks = seq(min(1960), max(2017), by=10))+
  ggtitle("World Capture fisheries production VS Aquaculture production")
  
plot.animation= cap_farm_trend+
transition_reveal(Year)+
view_follow(fixed_y=T)
animate(plot.animation, height=365,width=608,fps=30,duration=10,end_pause = 120,res=100,rewind=F)
anim_save("Capture fisheries production VS Aquaculture production in the world.gif")
```



### Countries which contribute the most to aquaculture over the years 

In this section, we are going to explore the countries which contribute significantly to aquaculture over the years. As data might not be available pre-2000s for some of the countries, we decided to focus on data after year 2000. Similar to before, we'll be performing an inner join with the dataset called iso3166 from the *maps* package to extract only countries relevant dataset as the original dataset contains other regions as well. 


Table \@ref(tab:table1) shows the world 10 largest aquaculture producers from year 2000 onwards, among which China is the runaway leader followed by Peru, Indonesia, United States, India and Japan. China accounts accounts for around 56% of aquaculture in the world in 2015 as shown in the table \@ref(tab:table2).  The comprehensive aquaculture extension (AE) system and the opening up in 1978 play a significant role in China in promoting the development of their aquaculture industry (Wang, P., Ji, J., & Zhang, Y. (2020)). This is consistent with our expectation where high technology countries to contribute more to the aquaculture. However, it's worth noting a significant share of production in 2015 also came from the other Asia regions such as Indonesia, India, Vietnam and Philippines, where aquaculture is largely based on small-scale, non-commercial and family-based operations (Subasinghe, R., Soto, D., & Jia, J. (2009)).    


```{r table1, echo=FALSE, preserve = TRUE, fig.pos = 'H', out.extra = "", fig.cap = "Average wild fish caught vs aquaculture from year 2000 onwards"}
# Compute the top 10 countries that produce the most aquaculture from 2000 onwards 
avg_contribution <- country_cf %>% 
  filter (Year >= 2000) %>%
  group_by(Entity)%>%
  summarise(avg_captured = mean(captured, na.RM = TRUE),
            avg_aquaculture = mean(captured, na.RM = TRUE))%>%
  arrange(-avg_aquaculture) %>%
  mutate(rank = row_number())%>%
  filter(rank %in% 1:10) %>%
  mutate(across(avg_captured:avg_aquaculture, ~ scales::label_comma()(.x))) %>%
  rename(`Average wild fish caught (metric tons)` = avg_captured,
         `Average aquaculture (metric tons)` = avg_aquaculture)


kable(head(avg_contribution,10), caption = "Top 10 countries for Aquaculture Production")%>% 
  kable_styling(font_size = 15, bootstrap_options = c("striped", "hover", "condensed"))

```


```{r table2, echo=FALSE}
# Compute the top 10 countries that produce the most aquaculture from 2000 onwards 
world_aqua <- world_cap_farm %>% filter (Year == 2015,
                                         production_type == "aquaculture")
                              
aqua2015 <- country_cf %>% 
  filter (Year == 2015, 
          Entity %in% c(avg_contribution$Entity))%>%
  mutate(percentage = aquaculture / (world_aqua$production) * 100) %>%
  select(Entity, Year, percentage ) %>%
  arrange(-percentage) %>%
  mutate_if(is.numeric, round, digits = 2)%>%
  rename(`Percentage relative to world production` = percentage)
  
kable(head(aqua2015,10), caption = "Top 10 countries for Aquaculture Production") %>% 
  kable_styling(font_size = 15, bootstrap_options = c("striped", "hover", "condensed"))
```

### Trend of captured fishery production VS Aquaculture over time among the top 10 countries

```{r cf3, echo=FALSE, , preserve = TRUE, fig.pos = 'H', out.extra = "", fig.width = 15, fig.cap = "Individual plots of the captured fishery production VS Aquaculture over time among the top 10 countries"}


cf_data_long <- captured_vs_farmed_long  %>% filter (Year >= 2000) %>%
  mutate(Entity = toupper(Entity)) %>%
  filter (Entity %in% c(avg_contribution$Entity))

trend_country_cf2 <- cf_data_long%>%
  ggplot(aes(x = Year,
           y = (production/1000000),
           colour = production_type))+
  geom_line()+
  labs(x = "Year", y = "Production (metric tons in millions)")+
  scale_y_continuous(labels = scales::label_comma(scale = 1e-0))+
  scale_x_continuous(breaks = seq(2000, 2017, by= 10))+ facet_wrap(~ Entity, scales =  "free", nrow = 4)

ggplotly(trend_country_cf2)



```


Aquaculture production within each region is diverse. In figure \@ref(fig:cf3), most countries display an increasing trend in aquaculture production, especially in the Asia region, including China, India, Indonesia, Philippines and Vietnam. This pattern is consistent with our initial expectation, not to mention that aquaculture production has also surpassed the wild fish captured in these countries in the recent years.  In contrast, some countries are still relying more on the fisheries compared to aquaculture at the recent stage, including Japan, United States, Peru and Chile.  


## **What is the contribution of each country in the global fishery sector ?**


```{r message=FALSE, warning=FALSE, echo=FALSE}
production_cleaned <- production %>%
  mutate( Pelagic_fish = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Pelagic Fish - 2763 - Production - 5510 - tonnes`,
          Crustaceans = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Crustaceans - 2765 - Production - 5510 - tonnes`,
          Cephalopods = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Cephalopods - 2766 - Production - 5510 - tonnes`,
          Demersal_fish = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Demersal Fish - 2762 - Production - 5510 - tonnes`,
          Freshwater_fish = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Freshwater Fish - 2761 - Production - 5510 - tonnes`,
          Molluscs_Others = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Molluscs, Other - 2767 - Production - 5510 - tonnes`,
          Marine_fish_other = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Marine Fish, Other - 2764 - Production - 5510 - tonnes`) %>%
  select(-`Commodity Balances - Livestock and Fish Primary Equivalent - Pelagic Fish - 2763 - Production - 5510 - tonnes`,
         -`Commodity Balances - Livestock and Fish Primary Equivalent - Crustaceans - 2765 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Cephalopods - 2766 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Demersal Fish - 2762 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Freshwater Fish - 2761 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Molluscs, Other - 2767 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Marine Fish, Other - 2764 - Production - 5510 - tonnes`)
  
```

```{r message=FALSE, warning=FALSE}
production_total <- production_cleaned %>%
  group_by(Entity) %>%
  summarise(Total = sum(Pelagic_fish, 
                        Crustaceans,
                        Cephalopods,
                        Demersal_fish,
                        Freshwater_fish,
                        Molluscs_Others,
                        Marine_fish_other,
                        na.rm = T
                        ))
```

The data from "production.csv" had to be wrangled to make the best use of the data-set. The variables had to be renamed and total fish production had to be calculated to find the top producers of fish in the world. 

```{r production, message=FALSE, warning=FALSE, fig.cap="Top fish producers of the world", fig.align='center'}
production_bar <- plot_ly(production_total,
                          x = ~Entity,
                          y = ~Total,
                          type = 'bar',
                          barmode = 'stack'
                          ) %>% 
  layout(xaxis = list(title = 'Year',categoryorder = "total ascending", tickangle = 45),
         yaxis = list(title = 'Fish Production (Tonnes)'),
         title = "Top fish producers of the world"
         )
production_bar
```

From the Figure \@ref(fig:production)) we can see the top producers in the world. If we exclude the continental observations and group of countries according to their economic development we can see that China,Japan,Peru and United States have been the top producers of the world. These countries have very large coastal regions, and are able to exploit them to their advantage. Another benefit of having a large coastal region is that these countries have high consumption of fish and most of their cuisine is based around fish. 

Similarly we can see that, the countries that are at the bottom of the fish production table are the arid regions of the world. These countries include Lesotho, Kyrgyzstan, Tajikistan and Jordan. They have very few sources of water and mostly consume meat to supplement their diet.

These findings are within expectations of initial analysis. Countries having a very large coastal line are more dependent on fish for their diet and can even sell them in the international market while the land locked and dry regions have a very minuscule share of fish production in the world.

```{r type, message=FALSE, warning=FALSE, fig.cap="Fish Production in the World", fig.align='center'}
production_plot <- plot_ly(production_cleaned,
                           type = 'scatter',
                           mode = 'markers') %>%
  layout(xaxis = list(title = 'Year'),
         yaxis = list(title = 'Fish Production (Tonnes)'),
         title = "Fish Production in the World",
         legend = list(title=list(text='<b> Type of Fish </b>'))
         )
  
production_plot <- production_plot %>%
  add_trace(x = production_cleaned$Year,
            y = production_cleaned$Pelagic_fish,
            marker = list(color = production_cleaned$Entity),
            hoverinfo = production_cleaned$Entity,
            showlegend = T,
            hoverinfo = 'text',
            text = ~paste('Country/Continent:', Entity),
            name = "Pelagic Fish")
production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Crustaceans, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Crustaceans")
production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Cephalopods, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Cephalopods")
production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Demersal_fish, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Demersal Fish")
production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Freshwater_fish, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Freshwater Fish")
production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Molluscs_Others, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Molluscs and others")
production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Marine_fish_other, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Marine Fish and others")
production_plot
```

From the Figure \@ref(fig:type)), we can observe the trend of fish production in the world according to the types of fishes that are being consumed around the world. **"Freshwater fishes"** and **"pelagic fishes"** make up the majority of fish production in the world while **"marine fish"** and **"cephalopods"** are at the bottom of fish production trend.

It is clear that the fish production has always shown a upward trend and the majority of fish that is being consumed around the world is from freshwater sources or from pelagic zones of the oceans. 

This trend does not deviate from expectation, as the population growth will always demand more seafood for consumption. It is a little unexpected that the majority of the food production is based around freshwater fishes while marine fish are at the bottom of the table.

## **What has been the trend of sustainable levels of fish stocks in the world ?**

```{r message=FALSE, warning=FALSE}
stock_world <- stock %>% 
  mutate(Sustainable_levels_Fish = stock$`Share of fish stocks within biologically sustainable levels (FAO, 2020)`,
         Overexploited_Fish = stock$`Share of fish stocks that are overexploited`) %>%
  select(-`Share of fish stocks within biologically sustainable levels (FAO, 2020)`,
         -`Share of fish stocks that are overexploited`) %>%
  slice(31:51)
```

The data from "stock.csv" had to be wrangled to remove irrelevant observations and the names of the variables had to be changed to make the data-set more presentable and easy to use.

```{r stock, message=FALSE, warning=FALSE, fig.cap= "Fish stock of the world", fig.align='center'}
stock_plot <- plot_ly(stock_world,
                           type = 'scatter',
                           mode = 'markers') %>% 
  layout(xaxis = list(title = 'Year',categoryorder = "total ascending"),
         yaxis = list(title = 'Fish Stock (percent)'),
         title = "Fish stock of the world",
         legend = list(title=list(text='<b> Fish stock type </b>'))
         )
  
stock_plot <- stock_plot %>%
  add_trace(x = stock_world$Year,
            y = stock_world$Sustainable_levels_Fish,
            mode='lines+markers',
            showlegend = T,
            hoverinfo = 'text',
            text = ~paste('Country/Continent:', Entity),
            name = "Sustainable Levels of Fish Stock")
stock_plot <- stock_plot %>%
  add_trace(x = stock_world$Year,
            y = stock_world$Overexploited_Fish,
            mode='lines+markers',
            showlegend = T,
            hoverinfo = 'text',
            text = ~paste('Country/Continent:', Entity),
            name = "Overexploited Fish Stock ")
stock_plot
```

From the Figure \@ref(fig:stock)), we can observe the trend of fish exploitation and sustainable levels in the world. It is evident from the trend of from the plot that the sustainable level of fish has been going downwards for a very long time due to over exploitation of fish stocks.

Since these two variables complement each other , we can observe that when one increases the other decreases and vice versa.

# References

Hannah Ritchie and Max Roser (2021) - "Biodiversity". Published online at OurWorldInData.org. Retrieved from: 'https://ourworldindata.org/biodiversity' [Online Resource]

Hughes E (2022). _tidytuesdayR: Access the Weekly 'TidyTuesday' Project Dataset_. R package version
  1.0.2, <https://CRAN.R-project.org/package=tidytuesdayR>.

Dumas, M. W. (1992). Productivity trends: prepared fish and seafoods industry. Monthly Lab. Rev., 115, 3.

Hosomi, R., Yoshida, M., & Fukunaga, K. (2012). Seafood consumption and components for health. Global journal of health science, 4(3), 72.

Jensen, Helen H. "Changes in seafood consumer preference patterns and associated changes in risk exposure." Marine Pollution Bulletin 53.10-12 (2006): 591-598.

Bennett, A., Patil, P., Kleisner, K., Rader, D., Virdin, J., & Basurto, X. (2018). Contribufion of fisheries to food and nutrifion security: Current knowledge, policy, and research.

Salinas, E., Van Doorn, R., & Redaelli, S. (2015). Maldives: Identifying Opportunities and Constraints to Ending Poverty and Promoting Shared Prosperity.

Wang, P., Ji, J., & Zhang, Y. (2020). Aquaculture extension system in China: development, challenges, and prospects. Aquaculture reports, 17, 100339.

Subasinghe, R., Soto, D., & Jia, J. (2009). Global aquaculture and its role in sustainable development. Reviews in aquaculture, 1(1), 2-9.
