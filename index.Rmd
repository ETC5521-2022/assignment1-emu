---
title: "ETC5521 Assignment 1"
subtitle: "Global Fishing"
team: [EMU]
author:
  - [Min Min Soh]
  - [Rohan Baghel]

date: "`r Sys.Date()`"
output:
   bookdown::html_document2:
    toc: yes
    df_print: paged
    number_sections: yes
    fig_caption: yes
---

[This assignment is for ETC5521 Assignment 1 by Team `r rmarkdown::metadata$team` comprising of `r knitr::combine_words(rmarkdown::metadata$author)`.]{style="color:#006DAE;"}


# Introduction and motivation (Emily)

Global fishing has received a great deal of attention in the media for the past decades. The rise of world population over the decades have increased the demand for seafood consumption across the world. Coastal countries such as Iceland and Maldives still mainly rely on fishing as one of the most important food sources.  In this analysis, our first research question would learn about the seafood consumption of each country across the years. We will also study about how much seafood are being produced by each country overtime.  

Meanwhile, the rise of seafood demands has increased pressure on fish stocks across the world. The health of fish population in the world remains as a concern with the rise of global fishing. There are claims that ongoing erosion of aqua diversity will eventually lead to global collapse of fisheries by 2048. It then prompts us to have a closer look at how much of fish stocks are caught within the sustainable levels over the years without overexploiting the fish populations.

Fish farming, also being known as aquaculture come into place, help to contribute to the seafood production  while alleviating the pressure of wild fisheries. This inspires us to further analyse the change in the trend of aquaculture as compared to wild fish catch over time. 

We begin by describing the data in the next section, how we source it and how we prepare the data for analysis. In the analysis section, we present our observations through graphical displays. Our main tool is R, a programming language for statistical computing and graphics, which we use to clean, analyse and graph the data.  


# Data description 


```{r echo=FALSE, message=FALSE, warning=FALSE}

library(tidyverse)
library(ggplot2)
library(tidytuesdayR)
library(plotly)
library(bookdown)
```

```{r echo=FALSE, message=FALSE, warning=FALSE}

farmed <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/aquaculture-farmed-fish-production.csv')

captured_vs_farmed <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/capture-fisheries-vs-aquaculture.csv')

captured <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/capture-fishery-production.csv')

consumption <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/fish-and-seafood-consumption-per-capita.csv')

stock <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/fish-stocks-within-sustainable-levels.csv')

fishery <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/global-fishery-catch-by-sector.csv')

production <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-10-12/seafood-and-fish-production-thousand-tonnes.csv')
```


The data set has been obtained from the website https://ourworldindata.org. The data comprises of seven files in the ".csv" format which is machine readable and can be used to analyze the state of fish production and consumption in the world. 

The data dictionary for the data set has been given below. They define the variables and their types in each of the data sets that has been given in the data set. 

# `aquaculture-farmed-fish-production.csv`

|variable                             |class     |description |
|:------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                 |double    |.           |
|Aquaculture production (metric tons) |double    |.           |

# `capture-fisheries-vs-aquaculture.csv`

|variable                                   |class     |description |
|:------------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                       |double    | Year|
|Aquaculture production (metric tons)       |double    | Production of aquaculture animals|
|Capture fisheries production (metric tons) |double    | Captured aquaculture |

# `capture-fishery-production.csv`

|variable                                   |class     |description |
|:------------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                       |double    | Year |
|Capture fisheries production (metric tons) |double    | Captured fisheres production |

# `fish-and-seafood-consumption-per-capita.csv`

|variable                                                       |class     |description |
|:--------------------------------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                                           |double    | Year |
|Fish, Seafood- Food supply quantity (kg/capita/yr) (FAO, 2020) |double    | Food supply in fish in kg/capita/year |

# `fish-stocks-within-sustainable-levels.csv`

|variable                                                                |class     |description |
|:-----------------------------------------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                                                    |double    | Year |
|Share of fish stocks within biologically sustainable levels (FAO, 2020) |double    | Share of sustainable fish stock |
|Share of fish stocks that are overexploited                             |double    | Share of fish stock that are overexploited |


# `global-fishery-catch-by-sector.csv`

|variable                            |class     |description |
|:-----------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                |double    | Year |
|Artisanal (small-scale commercial)  |double    | Catch by small-scale commercial |
|Discards                            |double    | Discarded quantities |
|Industrial (large-scale commercial) |double    | Large scale commercial |
|Recreational                        |double    | Recreational fishing |
|Subsistence                         |double    | Food caught to feed self/family |

# `seafood-and-fish-production-thousand-tonnes.csv`

|variable                                      |class     |description |
|:----------------------------------------------|:---------|:-----------|
|Entity                               |character | Country/entity |
|Code                                 |character | Country code (see `countrycode` R package) |
|Year                                          |double    |.           |
|Pelagic Fish - 2763 - Production - 5510 - tonnes       |double    | Pelagic Fish |
|Crustaceans - 2765 - Production - 5510 - tonnes        |double    | Crustaceans |
|Cephalopods - 2766 - Production - 5510 - tonnes        |double    | Cephalopods |
|Demersal Fish - 2762 - Production - 5510 - tonnes      |double    | Demersal |
|Freshwater Fish - 2761 - Production - 5510 - tonnes    |double    | Freshwater |
|Molluscs, Other - 2767 - Production - 5510 - tonnes    |double    | Molluscs |
|Marine Fish, Other - 2764 - Production - 5510 - tonnes |double    | Marine |

# Questions of interest

Q1 What is the contribution of each production sector in global fishery from 1950 ? 

Q2 **What is the contribution of each country in the global fishery sector ? ** 

Q3 What is the share of type of fishes produced in each country ? 

Q4 What is the production level of each country by capturing over the years ?

Q5 What is the production level of each country by farming over the years  ?

Q6 **What has been the trend of seafood consumption of each country over the years ? ** 

Q7 **What has been the trend of captured vs farmed production of each country over the years ? **   

Q8 **What has been the trend of sustainable levels of fish stocks in the world ? **   

Q9 What is the share of fishes of the that have been been overexploited in the world over the years ? 

Q10 How much of the fish stocks are maintained at sustainable levels in the world of world as compared to overall production level? 

Q11 What is the production level of fish by each continent ?

Q12 What is the consumption level of fish by each continent ?

Q13 What can we learn about the uses of fish catch by countries? 

Q14 What can we learn about the uses of fish catch across the years? 

Q15  Comparing seafood production to seafood consumption across the years 

Q16 What can we learn about the sustainable levels of fishing as compared to farming 

Q17 Would aquaculture alleviate the pressure of seafood consumption across the years? 

Q18 What can we observe about the seafood consumption in coastal countries and landlocked countries over time? 

Q19 What can we observe about the level of seafood being discarded in the world across the years?

Q20 How much fresh water produce in each country over time ? 

# Expected findings 

**What has been the trend of seafood consumption of each country over the years ? ** 

- We would expect that there is an increasing trend of seafood consumption levels over the years given that rise of population. 

- We would expect that coastal countries consumed more seafood than landlocked countries. 

**What has been the trend of captured vs farmed production of each country over the years ? **  

- We would expect that the farmed production to be increasing over the years. 

- We would expect the high technology countries to contribute more to the farmed production. 

**What is the contribution of each country in the global fishery sector ?**

- The expectation is that of growing trend in fishing for each country for feeding the increasing populace.

- Countries that are landlocked or that do not have a big coastline will be contributing less to the fishery sector.

**What has been the trend of sustainable levels of fish stocks in the world ?**

- An increase in the trend of over-exploitation of fish stocks all over the world.

- A decreasing trend in the biologically sustainable levels of fish stocks all over the world.


# Analysis and findings

```{r message=FALSE, warning=FALSE, echo=FALSE}

production_cleaned <- production %>%
  mutate( Pelagic_fish = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Pelagic Fish - 2763 - Production - 5510 - tonnes`,
          Crustaceans = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Crustaceans - 2765 - Production - 5510 - tonnes`,
          Cephalopods = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Cephalopods - 2766 - Production - 5510 - tonnes`,
          Demersal_fish = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Demersal Fish - 2762 - Production - 5510 - tonnes`,
          Freshwater_fish = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Freshwater Fish - 2761 - Production - 5510 - tonnes`,
          Molluscs_Others = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Molluscs, Other - 2767 - Production - 5510 - tonnes`,
          Marine_fish_other = production$`Commodity Balances - Livestock and Fish Primary Equivalent - Marine Fish, Other - 2764 - Production - 5510 - tonnes`) %>%
  select(-`Commodity Balances - Livestock and Fish Primary Equivalent - Pelagic Fish - 2763 - Production - 5510 - tonnes`,
         -`Commodity Balances - Livestock and Fish Primary Equivalent - Crustaceans - 2765 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Cephalopods - 2766 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Demersal Fish - 2762 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Freshwater Fish - 2761 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Molluscs, Other - 2767 - Production - 5510 - tonnes`,
        -`Commodity Balances - Livestock and Fish Primary Equivalent - Marine Fish, Other - 2764 - Production - 5510 - tonnes`)
  

```

```{r message=FALSE, warning=FALSE}
production_total <- production_cleaned %>%
  group_by(Entity) %>%
  summarise(Total = sum(Pelagic_fish, 
                        Crustaceans,
                        Cephalopods,
                        Demersal_fish,
                        Freshwater_fish,
                        Molluscs_Others,
                        Marine_fish_other,
                        na.rm = T
                        ))
```

The data from "production.csv" had to be wrangled to make the best use of the data-set. The variables had to be renamed and total fish production had to be calculated to find the top producers of fish in the world. 

```{r production, message=FALSE, warning=FALSE, fig.cap="Top fish producers of the world", fig.align='center'}
production_bar <- plot_ly(production_total,
                          x = ~Entity,
                          y = ~Total,
                          type = 'bar',
                          barmode = 'stack'
                          ) %>% 
  layout(xaxis = list(title = 'Year',categoryorder = "total ascending", tickangle = 45),
         yaxis = list(title = 'Fish Production (Tonnes)'),
         title = "Top fish producers of the world"
         )

production_bar
```

From the Figure \@ref(fig:production)) we can see the top producers in the world. If we exclude the continental observations and group of countries according to their economic development we can see that China,Japan,Peru and United States have been the top producers of the world. These countries have very large coastal regions, and are able to exploit them to their advantage. Another benefit of having a large coastal region is that these countries have high consumption of fish and most of their cuisine is based around fish. 

Similarly we can see that, the countries that are at the bottom of the fish production table are the arid regions of the world. These countries include Lesotho, Kyrgyzstan, Tajikistan and Jordan. They have very few sources of water and mostly consume meat to supplement their diet.

These findings are within expectations of initial analysis. Countries having a very large coastal line are more dependent on fish for their diet and can even sell them in the international market while the land locked and dry regions have a very minuscule share of fish production in the world.

```{r type, message=FALSE, warning=FALSE, fig.cap="Fish Production in the World", fig.align='center'}
production_plot <- plot_ly(production_cleaned,
                           type = 'scatter',
                           mode = 'markers') %>%
  layout(xaxis = list(title = 'Year'),
         yaxis = list(title = 'Fish Production (Tonnes)'),
         title = "Fish Production in the World",
         legend = list(title=list(text='<b> Type of Fish </b>'))
         )
  

production_plot <- production_plot %>%
  add_trace(x = production_cleaned$Year,
            y = production_cleaned$Pelagic_fish,
            marker = list(color = production_cleaned$Entity),
            hoverinfo = production_cleaned$Entity,
            showlegend = T,
            hoverinfo = 'text',
            text = ~paste('Country/Continent:', Entity),
            name = "Pelagic Fish")

production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Crustaceans, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Crustaceans")

production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Cephalopods, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Cephalopods")

production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Demersal_fish, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Demersal Fish")

production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Freshwater_fish, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Freshwater Fish")

production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Molluscs_Others, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Molluscs and others")

production_plot <- production_plot %>% 
  add_trace( x = production_cleaned$Year,
             y = production_cleaned$Marine_fish_other, 
             mode = 'markers',
             showlegend = T,
             hoverinfo = 'text',
             text = ~paste('Country/Continent:', Entity),
             name = "Marine Fish and others")

production_plot
```

From the Figure \@ref(fig:type)), we can observe the trend of fish production in the world according to the types of fishes that are being consumed around the world. **"Freshwater fishes"** and **"pelagic fishes"** make up the majority of fish production in the world while **"marine fish"** and **"cephalopods"** are at the bottom of fish production trend.

It is clear that the fish production has always shown a upward trend and the majority of fish that is being consumed around the world is from freshwater sources or from pelagic zones of the oceans. 

This trend does not deviate from expectation, as the population growth will always demand more seafood for consumption. It is a little unexpected that the majority of the food production is based around freshwater fishes while marine fish are at the bottom of the table.

```{r message=FALSE, warning=FALSE}
stock_world <- stock %>% 
  mutate(Sustainable_levels_Fish = stock$`Share of fish stocks within biologically sustainable levels (FAO, 2020)`,
         Overexploited_Fish = stock$`Share of fish stocks that are overexploited`) %>%
  select(-`Share of fish stocks within biologically sustainable levels (FAO, 2020)`,
         -`Share of fish stocks that are overexploited`) %>%
  slice(31:51)
```

The data from "stock.csv" had to be wrangled to remove irrelevant observations and the names of the variables had to be changed to make the data-set more presentable and easy to use.

```{r stock, message=FALSE, warning=FALSE, fig.cap= "Fish stock of the world", fig.align='center'}
stock_plot <- plot_ly(stock_world,
                           type = 'scatter',
                           mode = 'markers') %>% 
  layout(xaxis = list(title = 'Year',categoryorder = "total ascending"),
         yaxis = list(title = 'Fish Stock (percent)'),
         title = "Fish stock of the world",
         legend = list(title=list(text='<b> Fish stock type </b>'))
         )
  

stock_plot <- stock_plot %>%
  add_trace(x = stock_world$Year,
            y = stock_world$Sustainable_levels_Fish,
            mode='lines+markers',
            showlegend = T,
            hoverinfo = 'text',
            text = ~paste('Country/Continent:', Entity),
            name = "Sustainable Levels of Fish Stock")

stock_plot <- stock_plot %>%
  add_trace(x = stock_world$Year,
            y = stock_world$Overexploited_Fish,
            mode='lines+markers',
            showlegend = T,
            hoverinfo = 'text',
            text = ~paste('Country/Continent:', Entity),
            name = "Overexploited Fish Stock ")

stock_plot
```

From the Figure \@ref(fig:stock)), we can observe the trend of fish exploitation and sustainable levels in the world. It is evident from the trend of from the plot that the sustainable level of fish has been going downwards for a very long time due to over exploitation of fish stocks.

Since these two variables complement each other , we can observe that when one increases the other decreases and vice versa.

# References

Hannah Ritchie and Max Roser (2021) - "Biodiversity". Published online at OurWorldInData.org. Retrieved from: 'https://ourworldindata.org/biodiversity' [Online Resource]
